<ion-header [translucent]="true">
<ion-toolbar color="light">
   <ion-buttons slot="start" (click)="closeModal()">
      <ion-button style="margin-top: 8px;">
       <ion-icon name="close-circle-outline" style="color: rgb(12, 12, 12);font-size: 32px;">
 
       </ion-icon>
      </ion-button>
     </ion-buttons>
      <ion-buttons style="display: none;" slot="end" (click)="closeModal()">
      <ion-button style="margin-top: 8px;letter-spacing: normal;">
        ${{this.precioToppingMasProducto * countAdd}}
      </ion-button>
     </ion-buttons>
<ion-title style="margin-top: 2px;font-style: italic;">
  {{this.arrayItem['nombre']}}
</ion-title>
</ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="container">
    <!-- <ion-icon 
    (click)="closeModal()" 
    style="color: rgb(39, 39, 39); background: #f7f7f7; border-radius: 44px;padding: 5px;box-shadow: 1px 1px 0 0 gray;" 
    name="arrow-back-outline" 
    class="close-icon"></ion-icon> -->
     <img src="{{this.arrayItem['imageLowRes']}}"
     style="height: 240px;width: 240px;border-radius: 15px;
      margin-top: 3px;
      box-shadow: 1px 0px 5px 0px #93939363;" 
     
     alt="Descripción de la imagen">
  </div>
<div style=" 
  background: rgb(255, 255, 255); 
  backdrop-filter: blur(10px);
  margin-left: 11px;
  margin-right: 11px;
  -webkit-backdrop-filter: blur(10px); /* Safari */
border-radius: 20px;
      box-shadow: 1px 0px 5px 0px #93939363;
  position: relative;
  bottom: -5px;
  padding: 16px;
  padding-top: 10px;
  padding-bottom: 10px;
  padding-left: 16px;
  padding-right: 16px;
  
  ">

  <div style="color: rgb(0, 0, 0); font-weight: bold; 
  font-size: 21px;
  border-radius: 20px;
  margin-top: 0px;
  padding-top: 0px;
 top: 0px;;
  font-style:Inter,ui-sans-serif,
  system-ui,sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';
  text-align: left;padding-left: 15px;">
    {{this.arrayItem['nombre']}}

  </div>
  <div style="color: rgb(10, 130, 86); font-size: 19px;font-style: 'titulos';text-align: left;padding-left: 15px;padding-top: 5px;padding-bottom: 5px;">
    <b>${{this.arrayItem['precio']}}</b>
  </div>
  <div style="color: rgb(58, 58, 58); font-size: 15px;font-style: 'titulos';text-align: left;padding-left: 15px;">
    {{this.arrayItem['desc']}}
  </div>
</div>



  <ion-item style="display: none;" *ngIf="Ind === ''">
    <ion-icon name="create-outline" slot="start"></ion-icon>
    <ion-label style="color: black;">Agregar una nota</ion-label>
  </ion-item>

  <ion-item  *ngIf="Ind !== ''" color="dark">
    <ion-icon name="create-outline" slot="start"></ion-icon>
    <ion-label style="color: rgb(241, 170, 76); font-size: 13px;">
      <b>Indicaciones: {{ Ind }}</b>
    </ion-label>
  </ion-item>

  <!-- Accordion para seleccionar tamaño del producto, sabor, ingredientes y extras -->
  <ion-accordion-group [multiple]="true" [value]="['tamanos','sabores','ingredientes', 'ingredientesExtras']" 
  style="margin-top: 1px;padding: 10px;border-radius: 20px;">
    <!-- Accordion Tamaño -->
    <ion-accordion  style="display: none;"  value="tamanos" expanded="true">
      <ion-item slot="header" color="light">
        <ion-label style="font-size: 17px;font-weight: bold;color: #000;">{{this.arrayItem['nameTopping']}}</ion-label>
        <ion-chip color="dark" slot="end" style="color: rgb(0, 0, 0);">Obligatorios</ion-chip>
      </ion-item>
      <div  slot="content">
        <ion-list>
          <ion-radio-group mode="md">
            <ion-item *ngFor="let tamano of tamanos">
              <ion-label style="font-size: 18px;color: #000;">{{ tamano.label }}</ion-label>
              <ion-radio slot="start" [value]="tamano.value"></ion-radio>
            </ion-item>
          </ion-radio-group>
        </ion-list>
      </div>
    </ion-accordion>

    <!-- Accordion Sabor -->
    <ion-accordion style="display: none;"  value="sabores" expanded="true">
      <ion-item slot="header" color="light">
        <ion-label style="color: #000;">Sabor</ion-label>
        <ion-chip color="dark" slot="end" style="color: rgb(0, 0, 0);"> <b>Obligatorio</b></ion-chip>
      </ion-item>
      <div  slot="content">
        <ion-list>
          <ion-radio-group  color="dark" mode="md">
            <ion-item *ngFor="let sabor of sabores">
              <ion-label style="color: #000;">{{ sabor.label }}</ion-label>
              <ion-radio slot="start" [value]="sabor.value"></ion-radio>
            </ion-item>
          </ion-radio-group>
        </ion-list>
      </div>
    </ion-accordion>

    <!-- Accordion Ingredientes -->
    <ion-accordion value="ingredientes" style="margin-top: 16px;background: #f5f5f5;padding-top: 12px;padding-right: 0 px;padding-left: 0px;border-radius: 20px;padding-bottom: 5px;" expanded="true"  *ngFor="let ingrediente of arrayItem['addons']; let xi = index">
      <ion-item slot="header"  style="width: 100%;--background: #f5f5f5;" >
        <ion-label slot="start"
        style="font-weight: 600;font-size: 16px; width: 100px; font-style:Inter,ui-sans-serif,
  system-ui,sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';
        padding: 0px;border-radius: 15px;color: #000;
        text-align: left;">  {{ ingrediente['nameTopping'] }}<br>
      <b style="font-size: 10px;color: gray;display: none;">Min. {{ingrediente['minMultiple']}} - Max. {{ingrediente['maxMultiple']}}</b>  
      </ion-label>
        <ion-chip *ngIf="ingrediente['isMandatory']" color="primary" slot="end" style="color: rgb(0, 0, 0);background: #eee; 
        font-weight: bold;font-size: 10px;
    width: 90px;"> <b>OBLIGATORIO</b></ion-chip>
             <ion-chip color="primary" *ngIf="!ingrediente['isMandatory']" color="primary" slot="end" style="color: rgb(0, 0, 0);background: #eee; 
        font-weight: bold;">Opcional</ion-chip>
      </ion-item>

      <div  slot="content">
        <div *ngIf="ingrediente['type'] === 'multiple'" style="margin-top: 5px;color: #000;">
          <ion-list *ngFor="let ingredientecheckBox of ingrediente['arrayToppings']">
            <ion-item  style="--background: #f5f5f5;" >
              <ion-label style="font-family: 'titulos'; font-size: 14px;color: #222222;">{{ ingredientecheckBox.name }}      +${{ ingredientecheckBox.Precio }}</ion-label>
             
              <ion-checkbox color="dark" disabled="{{!ingredientecheckBox.active}}" mode="md" slot="end" [value]="ingredientecheckBox.name" 
                            (ionChange)="actualizarPrecioCheck($event, ingredientecheckBox, xi,ingrediente)">
              </ion-checkbox>
            </ion-item>
          </ion-list>
          
      </div>
      <ion-list>
        <ion-radio-group color="dark" *ngIf="ingrediente['type'] === 'single'" style="margin-top: 5px;"
                         (ionChange)="actualizarPrecio($event, ingrediente, xi)">
          <ion-item style="--background: #f5f5f5;" *ngFor="let ingredienteRadio of ingrediente['arrayToppings']">
            <ion-label 
              [ngStyle]="{'color': !ingredienteRadio.active ? 'gray' : 'black'}" 
              style="font-family: 'titulos'; font-size: 15px;color: #000;">
              {{ ingredienteRadio.name }}      +${{ ingredienteRadio.Precio }}
            </ion-label>
     
            <ion-radio [disabled]="!ingredienteRadio.active" 
                       mode="md" 
                       slot="end" 
                       color="dark"
                       [value]="ingredienteRadio">
            </ion-radio>
          </ion-item>
        </ion-radio-group>
      </ion-list>
      <div *ngIf="ingrediente['type'] === 'increment'" slot="content">
        <!-- Incrementador de Ingredientes usando arrayToppings -->
        <ion-list>
          <b style="font-size: 12px;color: gray; margin-left: 15px;" *ngIf="ingrediente['isMandatory'] === true">
            Selecciona maximo {{ ingrediente['min'] }} </b>
            <b style="font-size: 12px;color: gray; margin-left: 15px;" *ngIf="ingrediente['isMandatory'] === false">
              Selecciona de {{ ingrediente['min'] }} a {{ ingrediente['max'] }}</b>
          <ion-item *ngFor="let ingredienteRadio of ingrediente['arrayToppings']">
            <ion-label style="font-family: 'titulos'; font-size: 15px;color: #000;">
              {{ ingredienteRadio.name }} +${{ ingredienteRadio.Precio }}
            </ion-label>
            
            <!-- Botón para Decrementar -->
      <!-- Botón para Decrementar -->
<div 
  [class.disabled]="ingredienteRadio.isBlocked"
  class="btn-tap"
  (click)="!ingredienteRadio.isBlocked && decrementarCantidad(ingredienteRadio, ingrediente, xi)"
  style="
    height: 25px;
    width: 25px;
    border-radius: 10px;
    background: linear-gradient(135deg, #1a1a1a 0%, #000000 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    margin-right: 1px;
  ">
  <ion-icon 
    name="remove-outline" 
    style="font-size: 16px; color: #ffffff;">
  </ion-icon>
</div>

<!-- Cantidad Actual -->
<div style="font-size: 16px; font-weight: bold; margin: 0 10px; color: #000;">
  {{ ingredienteRadio.cantidad || 0 }}
</div>

<!-- Botón para Incrementar -->
<div 
  class="btn-tap"
  (click)="incrementarCantidad(ingredienteRadio, ingrediente, xi)"
  style="
    height: 25px;
    width: 25px;
    border-radius: 10px;
    background: linear-gradient(135deg, #1e1e1e 0%, #000000 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
  ">
  <ion-icon 
    name="add-outline" 
    style="font-size: 16px; color: #ffffff;">
  </ion-icon>
</div>

          
          </ion-item>
        </ion-list>
      </div>
      
      </div>
    </ion-accordion>
    
  </ion-accordion-group>

  <!-- Botón para confirmar selección -->
  <div *ngIf="writeNota">
    <br>
  </div>
  <ion-item *ngIf="writeNota" fill="outline" mode="md">
    <ion-label position="floating" style="color: #000;">Escribe una nota</ion-label>
    <ion-textarea maxlength="100"></ion-textarea>
  </ion-item>
 
 
  <br>
  <br>
  <br>
</ion-content>
<ion-footer style="margin-bottom: 20px;">

  <ion-row>

    <ion-col size="0.3">

    </ion-col>

    <ion-col size="4.9">
  
        <ion-row style="margin-top: 5px;">
          <ion-col size="12">
            <div style="display: flex; justify-content: center; align-items: center; 
            background: #eeeeee; border-radius: 18px; padding: 3px;margin-top: 0px;">
              <ion-button fill="clear" size="small" (click)="removeCount()">
                <ion-icon name="remove-circle-outline" style="color: black; font-size: 32px;margin-right: 3px;"></ion-icon>
              </ion-button>
              <span style="margin: 0 7px;color: #000;">{{ countAdd }}</span>
              <ion-button fill="clear" size="small" (click)="addCount()">
                <ion-icon style="color: black; font-size: 32px;margin-right: 3px;" name="add-circle-outline"></ion-icon>
              </ion-button>
            </div>
          </ion-col>
          
    

       
        </ion-row>
  
    
    
    </ion-col>
    <ion-col size="0.3">

    </ion-col>
    <ion-col size="6.3">
            
      <ion-button 
      (click)="addToCart()" 
      color="dark" 
      style="margin-top: 7px;"
      expand="block" 

      [disabled]="dismissed">
      <div style="font-size: 11px; font-weight: 300; letter-spacing: 1px; width: 100%;">
        <b style="font-size: 15px; margin-top: 0px;font-style: italic;color: white;">AGREGAR +${{this.precioToppingMasProducto * countAdd}}</b>
      </div>
      <ion-spinner slot="end" *ngIf="dismissed" name="crescent"></ion-spinner>
    </ion-button>
    

  </ion-col>

  <ion-col size="0.2">

    </ion-col>


  </ion-row>
  
  </ion-footer>